#!/usr/bin/env ruby

require 'rubygems'
require "#{File.dirname(__FILE__)}/../lib/bananajour"

Bananajour.setup! unless Bananajour.setup?

case ARGV.first

when nil, "serve"
  Bananajour.serve_web!
  Bananajour.serve_git!
  Bananajour.advertise!
  Bananajour.repositories.each {|r| r.advertise!}
  Process.wait

when "add"
  Bananajour.add!(ARGV[1] || File.expand_path("."))
  
when "help", "--help", "-h"
  puts <<-HELP
Usage: #{$0} [<command>]

Commands:
  none       - Start the web, git and bonjour serving
  add [path] - Adds a new project
HELP

else
  raise "Don't understand"

end
